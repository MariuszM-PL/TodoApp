<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:TodoApp.ViewModels"
             x:Class="TodoApp.Views.EditPage"
             x:DataType="vm:EditViewModel"
             Title="Edytuj zadanie">

    <ScrollView HorizontalScrollBarVisibility="Never">
        <Grid>
            <Border StrokeThickness="0"
                    BackgroundColor="Transparent"
                    HorizontalOptions="Center"
                    VerticalOptions="Start"
                    MaximumWidthRequest="600"
                    Margin="20">

                <VerticalStackLayout Spacing="20">

                    <Label Text="Edycja zadania" 
                           FontSize="22" 
                           FontAttributes="Bold" 
                           TextColor="{DynamicResource Primary}"/>

                    <VerticalStackLayout Spacing="5">
                        <Label Text="TytuÅ‚:" FontAttributes="Bold"/>
                        <Entry Text="{Binding TodoItem.Title}" 
                               HorizontalOptions="Fill"
                               TextColor="{AppThemeBinding Light=Black, Dark=White}"
                               BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#2C2C2C}"/>
                    </VerticalStackLayout>

                    <VerticalStackLayout Spacing="5">
                        <Label Text="Opis:" FontAttributes="Bold"/>
                        <Editor Text="{Binding TodoItem.Description}" 
                                AutoSize="TextChanges" 
                                HeightRequest="100"
                                HorizontalOptions="Fill"
                                TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#2C2C2C}"/>
                    </VerticalStackLayout>

                    <FlexLayout Wrap="Wrap" JustifyContent="SpaceBetween">

                        <VerticalStackLayout Spacing="5" FlexLayout.Basis="31%" FlexLayout.Grow="1" Margin="0,0,5,10" MinimumWidthRequest="150">
                            <Label Text="Termin:" FontAttributes="Bold"/>
                            <DatePicker Date="{Binding TodoItem.DueDate}" 
                                        Format="dd/MM/yyyy" 
                                        HorizontalOptions="Fill"
                                        TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                        BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#2C2C2C}"/>
                        </VerticalStackLayout>

                        <VerticalStackLayout Spacing="5" FlexLayout.Basis="31%" FlexLayout.Grow="1" Margin="5,0,5,10" MinimumWidthRequest="150">
                            <Label Text="Godzina:" FontAttributes="Bold"/>
                            <TimePicker Time="{Binding EditTodoTime}" 
                                        HorizontalOptions="Fill"
                                        TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                        BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#2C2C2C}"/>
                        </VerticalStackLayout>

                        <VerticalStackLayout Spacing="5" FlexLayout.Basis="31%" FlexLayout.Grow="1" Margin="5,0,0,10" MinimumWidthRequest="150">
                            <Label Text="Kategoria:" FontAttributes="Bold"/>
                            <Picker ItemsSource="{Binding Categories}"
                                    SelectedItem="{Binding TodoItem.Category}"
                                    Title="Wybierz"
                                    HorizontalOptions="Fill"
                                    TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                    BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#2C2C2C}"/>
                        </VerticalStackLayout>
                    </FlexLayout>

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="15" Margin="0,10,0,0">
                        <Button Grid.Column="0" 
                                Text="Zapisz zmiany" 
                                Command="{Binding UpdateTaskCommand}"
                                HeightRequest="50"
                                CornerRadius="10"/>

                        <Button Grid.Column="1" 
                                Text="Anuluj" 
                                Command="{Binding CancelCommand}" 
                                BackgroundColor="Transparent"
                                TextColor="{DynamicResource Primary}"
                                BorderColor="{DynamicResource Primary}"
                                BorderWidth="2"
                                HeightRequest="50" 
                                Padding="10,0"
                                CornerRadius="10"/>
                    </Grid>
                </VerticalStackLayout>
            </Border>
        </Grid>
    </ScrollView>
</ContentPage>